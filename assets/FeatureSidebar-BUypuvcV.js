import{_ as $,W as D,u as F,k as N,r as n,g as S,i as V,o as r,c as i,a as s,h as m,w as v,n as y,t as l,f as b,F as k,e as j,S as B,d as E}from"./index-BvQQ6c71.js";const P={class:"feature-sidebar"},z={class:"sidebar-menu"},H={class:"history-section"},I={class:"history-list"},M={key:0,class:"empty-history"},q={key:1,class:"empty-history error"},A={class:"sidebar-text"},G={key:2,class:"empty-history"},W=["onClick"],J={class:"sidebar-text history-title"},K={class:"dialog-content"},O={class:"dialog-header"},Q={class:"dialog-body"},U={class:"record-timestamp"},X={class:"record-params"},Y={class:"param-item"},Z={class:"param-value"},ss={class:"param-item"},es={class:"param-value"},as={class:"param-item"},ts={class:"param-value"},os={class:"record-result"},ls={class:"result-content"},rs={__name:"FeatureSidebar",setup(is){const w=D(),x=F(),d=N(()=>w.path),c=n([]),_=n(!1),u=n(null),g=n(!1),o=n({}),L=async()=>{_.value=!0,u.value=null;try{const t=await fetch("http://localhost:3000/api/user-records",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){const a=await t.json();throw console.error("APIé”™è¯¯è¯¦æƒ…:",a),new Error(`è·å–å†å²è®°å½•å¤±è´¥: ${t.status} ${t.statusText}`)}const e=await t.json();console.log("è·å–åˆ°çš„å†å²è®°å½•æ•°æ®:",e),c.value=e.records.map(a=>({id:a.id,title:`${f(a.usage_time)} - ${a.category_level1||""}${a.category_level2?"/"+a.category_level2:""}`,params:{categoryL1:a.category_level1,categoryL2:a.category_level2,priceRange:a.price_range},result:a.trend_report||a.market_overview||a.popular_features||a.selection_plan||"æš‚æ— åˆ†æç»“æœ",timestamp:f(a.usage_time)}))}catch(t){console.error("è·å–å†å²è®°å½•å‡ºé”™:",t),u.value=t.message,c.value=[{id:1,title:"å¥³è£…Tæ¤åˆ†æ",params:{categoryL1:"å¥³è£…",categoryL2:"Tæ¤",priceRange:"50-100"},result:"å¥³è£…Tæ¤å¸‚åœºåˆ†ææŠ¥å‘Šï¼šæ ¹æ®æœ€æ–°æ•°æ®åˆ†æï¼Œå¥³è£…Tæ¤å¸‚åœºåœ¨50-100å…ƒä»·æ ¼åŒºé—´å‘ˆç°ç¨³å®šå¢é•¿è¶‹åŠ¿ã€‚æ¶ˆè´¹è€…æ›´åå¥½ç®€çº¦é£æ ¼ä¸äº®è‰²ç³»ï¼Œå°¤å…¶æ˜¯è“è‰²å’Œç²‰è‰²ç³»åˆ—ã€‚å»ºè®®å¢åŠ è¿™ä¸€ä»·æ ¼å¸¦çš„ç®€çº¦é£æ ¼Tæ¤åº“å­˜ï¼Œå¹¶å…³æ³¨äº®è‰²ç³»äº§å“çš„æ¨å¹¿ã€‚",timestamp:"2023-06-15 14:30"},{id:2,title:"ç”·è£…ç‰›ä»”è£¤åˆ†æ",params:{categoryL1:"ç”·è£…",categoryL2:"ç‰›ä»”è£¤",priceRange:"100-200"},result:"ç”·è£…ç‰›ä»”è£¤å¸‚åœºåˆ†ææŠ¥å‘Šï¼š100-200å…ƒä»·æ ¼åŒºé—´çš„ç”·è£…ç‰›ä»”è£¤å¸‚åœºç«äº‰æ¿€çƒˆï¼Œä½†ä»æœ‰å¢é•¿ç©ºé—´ã€‚ç›´ç­’å’Œå¾®é”¥å½¢å‰ªè£æœ€å—æ¬¢è¿ï¼Œæ·±è“è‰²å’Œé»‘è‰²æ˜¯ä¸»æµé¢œè‰²ã€‚å»ºè®®å…³æ³¨è€ç©¿æ€§å’Œèˆ’é€‚åº¦ä½œä¸ºä¸»è¦å–ç‚¹ï¼ŒåŒæ—¶å¯ä»¥è€ƒè™‘åŠ å…¥å°‘é‡å¼¹æ€§é¢æ–™çš„äº§å“ä»¥æå‡èˆ’é€‚åº¦ã€‚",timestamp:"2023-06-14 10:15"}],console.log("ä½¿ç”¨ç¤ºä¾‹æ•°æ®ä»£æ›¿")}finally{_.value=!1}},f=t=>t?new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"æœªçŸ¥æ—¶é—´";S(()=>{L()});const C=t=>{o.value=t,g.value=!0},p=()=>{g.value=!1},R=()=>{let t="/feature/trend";o.value.params.categoryL1==="ç”·è£…"?t="/feature/market":o.value.params.categoryL2==="è¿è¡£è£™"?t="/feature/decode":o.value.params.priceRange==="50-100"&&(t="/feature/workshop"),x.push({path:t,query:{...o.value.params}}),p()};return(t,e)=>{const a=V("router-link");return r(),i(k,null,[s("div",P,[e[8]||(e[8]=s("div",{class:"sidebar-header"},[s("h3",null,"åŠŸèƒ½å¯¼èˆª")],-1)),s("div",z,[m(a,{to:"/feature/trend",class:y(["sidebar-item",{active:d.value==="/feature/trend"}])},{default:v(()=>e[0]||(e[0]=[s("span",{class:"sidebar-icon"},"ğŸ“ˆ",-1),s("span",{class:"sidebar-text"},"å“ç±»è¶‹åŠ¿å…ˆçŸ¥",-1)])),_:1},8,["class"]),m(a,{to:"/feature/market",class:y(["sidebar-item",{active:d.value==="/feature/market"}])},{default:v(()=>e[1]||(e[1]=[s("span",{class:"sidebar-icon"},"ğŸ”",-1),s("span",{class:"sidebar-text"},"å¸‚åœºè„‰æé¸Ÿç°",-1)])),_:1},8,["class"]),m(a,{to:"/feature/decode",class:y(["sidebar-item",{active:d.value==="/feature/decode"}])},{default:v(()=>e[2]||(e[2]=[s("span",{class:"sidebar-icon"},"ğŸ§©",-1),s("span",{class:"sidebar-text"},"çˆ†å“é£å°šè§£ç ",-1)])),_:1},8,["class"]),m(a,{to:"/feature/workshop",class:y(["sidebar-item",{active:d.value==="/feature/workshop"}])},{default:v(()=>e[3]||(e[3]=[s("span",{class:"sidebar-icon"},"âš™ï¸",-1),s("span",{class:"sidebar-text"},"çˆ†å“åŸºå› å·¥åŠ",-1)])),_:1},8,["class"]),s("div",H,[e[7]||(e[7]=s("div",{class:"history-header"},[s("span",{class:"sidebar-icon"},"ğŸ“œ"),s("span",{class:"sidebar-text"},"å†å²è®°å½•")],-1)),s("div",I,[_.value?(r(),i("div",M,e[4]||(e[4]=[s("span",{class:"sidebar-text"},"åŠ è½½ä¸­...",-1)]))):u.value?(r(),i("div",q,[s("span",A,l(u.value),1)])):c.value.length===0?(r(),i("div",G,e[5]||(e[5]=[s("span",{class:"sidebar-text"},"æš‚æ— è®°å½•",-1)]))):b("",!0),(r(!0),i(k,null,j(c.value,(h,T)=>(r(),i("div",{key:T,class:"history-item",onClick:ns=>C(h)},[e[6]||(e[6]=s("span",{class:"history-icon"},[s("i",{class:"fas fa-history"})],-1)),s("span",J,l(h.title),1)],8,W))),128))])])])]),g.value?(r(),i("div",{key:0,class:"history-dialog",onClick:B(p,["self"])},[s("div",K,[s("div",O,[s("h3",null,l(o.value.title),1),s("span",{class:"dialog-close",onClick:p},"Ã—")]),s("div",Q,[s("div",U,[e[9]||(e[9]=s("i",{class:"fas fa-clock"},null,-1)),E(" "+l(o.value.timestamp),1)]),s("div",X,[e[13]||(e[13]=s("h4",null,"æŸ¥è¯¢å‚æ•°",-1)),s("div",Y,[e[10]||(e[10]=s("span",{class:"param-label"},"ä¸€çº§ç±»ç›®:",-1)),s("span",Z,l(o.value.params.categoryL1),1)]),s("div",ss,[e[11]||(e[11]=s("span",{class:"param-label"},"äºŒçº§ç±»ç›®:",-1)),s("span",es,l(o.value.params.categoryL2),1)]),s("div",as,[e[12]||(e[12]=s("span",{class:"param-label"},"ä»·æ ¼èŒƒå›´:",-1)),s("span",ts,l(o.value.params.priceRange),1)])]),s("div",os,[e[14]||(e[14]=s("h4",null,"åˆ†æç»“æœ",-1)),s("div",ls,l(o.value.result),1)])]),s("div",{class:"dialog-footer"},[s("button",{class:"dialog-btn",onClick:p},"å…³é—­"),s("button",{class:"dialog-btn primary",onClick:R},"é‡æ–°åº”ç”¨å‚æ•°")])])])):b("",!0)],64)}}},cs=$(rs,[["__scopeId","data-v-79dde7bd"]]);export{cs as F};
